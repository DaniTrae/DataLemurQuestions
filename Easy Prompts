--Title: Page With No Likes--
--Summary: Assume you're given two tables containing data about Facebook Pages and their respective likes (as in "Like a Facebook Page").--
--Write a query to return the IDs of the Facebook pages that have zero likes. The output should be sorted in ascending order based on the page IDs.--
--NOTES: Out of the 5 pages in the dataset, 2 returned with having no likes on the page--

SELECT 
  pages.page_id
FROM 
  pages 
LEFT JOIN page_likes AS likes
  ON pages.page_id = likes.page_id
WHERE
  likes.page_id IS NULL;



--Title: Unfinished Parts--
--Summary: Tesla is investigating production bottlenecks and they need your help to extract the relevant data.--
--Write a query that determines which parts with the assembly steps have initiated the assembly process but remain unfinished.--
--NOTES: Wrote query to show which parts were in assembly with NULL finish dates.--

SELECT
  part,
  assembly_step
FROM
  parts_assembly
WHERE
  finish_date IS NULL;



--Title: Histogram of Tweets--
--Summary: Assume you're given a table Twitter tweet data, write a query to obtain a histogram of tweets posted per user in 2022.--
--Output the tweet count per user as the bucket and the number of Twitter users who fall into that bucket.--
--NOTES: Discovered in the year 2022 there was two users who posted once and one user who posted twice.--

SELECT
  tweet_count_per_user AS tweet_bucket,
  COUNT(user_id) AS users_num
FROM
(
  SELECT
   user_id,
   COUNT(tweet_id) AS tweet_count_per_user
  FROM
   tweets
  WHERE
   tweet_date BETWEEN '2022-01-01' AND '2022-12-31'
  GROUP BY
   user_id
) 
  AS total_tweets
GROUP BY tweet_count_per_user;



--Title: Laptop vs. Mobile Viewership--
--Summary: Assume you're given the table on user viewership categorised by device type where the three types are laptop, tablet, and phone.--
--Write a query that calculates the total viewership for laptops and mobile devices where mobile is defined as the sum of tablet and phone viewership.--
--Output the total viewership for laptops as laptop_reviews and the total viewership for mobile devices as mobile_views.--
--NOTES: Laptop viewer were two and mobile viewers were three.--

SELECT
  COUNT(*) FILTER (WHERE device_type = 'laptop') AS laptop_views,
  COUNT(*) FILTER (WHERE device_type IN ('tablet', 'phone')) AS mobile_views
FROM
  viewership;




